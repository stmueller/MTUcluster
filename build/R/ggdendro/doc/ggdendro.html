<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Using the <code>ggdendro</code> package to plot dendrograms</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>Using the <code>ggdendro</code> package to plot dendrograms</h1>

<p>The <code>ggdendro</code> package makes it easy to extract dendrogram and tree diagrams into a list of data frames.  You can then use this list to create these types of plots using the <code>ggplot2</code> package</p>

<h2>Introduction</h2>

<p>The <code>ggdendro</code> package provides a general framework to extract the plot data for dendrograms and tree diagrams.</p>

<p>It does this by providing generic function <code>dendro_data()</code> that extracts the appropriate segment and label data, returning the data as a list of data frames.  </p>

<p>You can access these data frames using three accessor functions:</p>

<ul>
<li><code>segment()</code></li>
<li><code>label()</code></li>
<li><code>leaf_label()</code></li>
</ul>

<p>The package also provides two convenient wrapper functions:</p>

<ul>
<li><code>ggdendrogram()</code> is a wrapper around <code>ggplot()</code> to create a dendrogram using a single line of code.  The resulting object is of class <code>ggplot</code>, so can be manipulated using the <code>ggplot2</code> tools.</li>
<li><code>theme_dendro()</code> is a <code>ggplot2</code> theme with a blank canvas, i.e. no axes, axis labels or tick marks.</li>
</ul>

<p>The <code>ggplot2</code> package doesn&#39;t get loaded automatically, so remember to load it first: </p>

<pre><code class="r">library(ggplot2)
library(ggdendro)
</code></pre>

<h2>Using the <code>ggdendrogram()</code> wrapper</h2>

<p>The <code>ggdendro</code> package extracts the plot data from dendrogram objects.  Sometimes it is useful to have fine-grained control over the plot.  Other times it might be more convenient to have a simple wrapper around <code>ggplot()</code> to produce a dendrogram with a small amount of code.</p>

<p>The function <code>ggdendrogram()</code> provides such a wrapper to produce a plot with a single line of code.  It provides a few options for controlling the display of line segments, labels and plot rotation (rotated by 90 degrees or not).  </p>

<pre><code class="r">hc &lt;- hclust(dist(USArrests), &quot;ave&quot;)
ggdendrogram(hc, rotate = FALSE, size = 2)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk dendrogram"/></p>

<p>The next section shows how to take full control over the data extraction and subsequent plotting.</p>

<h2>Extracting the dendrogram plot data using <code>dendro_data()</code></h2>

<p>The <code>hclust()</code> and <code>dendrogram()</code> functions in R makes it easy to plot the results of hierarchical cluster analysis and other dendrograms in R.  However, it is hard to extract the data from this analysis to customise these plots, since the <code>plot()</code> functions for both these classes prints directly without the option of returning the plot data.  </p>

<pre><code class="r">model &lt;- hclust(dist(USArrests), &quot;ave&quot;)
dhc &lt;- as.dendrogram(model)
# Rectangular lines
ddata &lt;- dendro_data(dhc, type = &quot;rectangle&quot;)
p &lt;- ggplot(segment(ddata)) + 
  geom_segment(aes(x = x, y = y, xend = xend, yend = yend)) + 
  coord_flip() + 
  scale_y_reverse(expand = c(0.2, 0))
p
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk dendro1"/></p>

<p>Of course, using <code>ggplot2</code> to create the dendrogram means one has full control over the appearance of the plot.  For example, here is the same data, but this time plotted horizontally with a clean background.  In <code>ggplot2</code> this means
passing a number of options to <code>theme</code>.  The <code>ggdendro</code> packages exports a function, <code>theme_dendro()</code> that wraps these options into a convenient function.</p>

<pre><code class="r">p + 
  coord_flip() + 
  theme_dendro()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk dendro-2"/></p>

<p>You can also draw dendrograms with triangular line segments (instead of rectangular segments).  For example:</p>

<pre><code class="r">ddata &lt;- dendro_data(dhc, type = &quot;triangle&quot;)
ggplot(segment(ddata)) + 
  geom_segment(aes(x = x, y = y, xend = xend, yend = yend)) + 
  coord_flip() + 
  scale_y_reverse(expand = c(0.2, 0)) +
  theme_dendro()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk dendro-3"/></p>

<h2>Regression tree diagrams</h2>

<p>The <code>tree()</code> function in package <code>tree</code> creates tree diagrams.  To extract the plot data for these diagrams using <code>ggdendro</code>, you use the the same idiom as for plotting dendrograms: </p>

<pre><code class="r">if(require(tree)){
  data(cpus, package = &quot;MASS&quot;)
  model &lt;- tree(log10(perf) ~ syct + mmin + mmax + cach + chmin + chmax, 
                data = cpus)
  tree_data &lt;- dendro_data(model)
  ggplot(segment(tree_data)) +
    geom_segment(aes(x = x, y = y, xend = xend, yend = yend, size = n), 
                 colour = &quot;blue&quot;, alpha = 0.5) +
    scale_size(&quot;n&quot;) +
    geom_text(data = label(tree_data), 
              aes(x = x, y = y, label = label), vjust = -0.5, size = 3) +
    geom_text(data = leaf_label(tree_data), 
              aes(x = x, y = y, label = label), vjust = 0.5, size = 2) +
    theme_dendro()
}
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk tree"/></p>

<h2>Classification tree diagrams</h2>

<p>The <code>rpart()</code> function in package <code>rpart</code> creates classification diagrams.  To extract the plot data for these diagrams using <code>ggdendro</code> follows the same basic pattern as dendrograms: </p>

<pre><code class="r">if(require(rpart)){
  model &lt;- rpart(Kyphosis ~ Age + Number + Start, 
                 method = &quot;class&quot;, data = kyphosis)
  ddata &lt;- dendro_data(model)
  ggplot() + 
    geom_segment(data = ddata$segments, 
                 aes(x = x, y = y, xend = xend, yend = yend)) + 
    geom_text(data = ddata$labels, 
              aes(x = x, y = y, label = label), size = 3, vjust = 0) +
    geom_text(data = ddata$leaf_labels, 
              aes(x = x, y = y, label = label), size = 3, vjust = 1) +
    theme_dendro()
}
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk rpart"/></p>

<h2>Twins diagrams: agnes and diana</h2>

<p>The <code>clusters</code> package allows you to draw agnes and diana diagrams.</p>

<pre><code class="r">if(require(cluster)){
  model &lt;- agnes(votes.repub, metric = &quot;manhattan&quot;, stand = TRUE)
  dg &lt;- as.dendrogram(model)
  ggdendrogram(dg)

  model &lt;- diana(votes.repub, metric = &quot;manhattan&quot;, stand = TRUE)
  dg &lt;- as.dendrogram(model)
  ggdendrogram(dg)
}
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk twins"/></p>

<h2>Conclusion</h2>

<p>The <code>ggdendro</code> package makes it easy to extract the line segment and label data from <code>hclust</code>, <code>dendrogram</code> and <code>tree</code> objects.</p>

</body>

</html>
